<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø·Ø¨Ø§Ø¹Ø© Ø¥Ø°Ù†</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 40px; }
        .slip { border: 2px solid #000; padding: 30px; max-width: 700px; margin: 0 auto; }
        h2 { text-align: center; margin-bottom: 10px; text-decoration: underline; }
        .type { text-align: center; font-size: 24px; font-weight: bold; margin-bottom: 30px; }
        .row { display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 18px; border-bottom: 1px dashed #ccc; padding-bottom: 5px; }
        .label { font-weight: bold; width: 150px; }
        .val { font-weight: bold; color: #333; flex: 1; }
        .amount { border: 2px solid #000; padding: 10px; text-align: center; font-size: 28px; font-weight: bold; margin: 30px 0; background: #eee; }
        .sigs { display: flex; justify-content: space-between; margin-top: 60px; }
        .sig { text-align: center; width: 30%; border-top: 1px solid #000; padding-top: 10px; }
        @media print { button { display: none; } }
    </style>
</head>
<body>
<div class="slip">
    <h2>WrapStyle ERP</h2>
    <div id="type" class="type">...</div>

    <div class="row"><span class="label">Ø±Ù‚Ù… Ø§Ù„Ø¥Ø°Ù†:</span> <span class="val" id="serial"></span></div>
    <div class="row"><span class="label">Ø§Ù„ØªØ§Ø±ÙŠØ®:</span> <span class="val" id="date"></span></div>
    <div class="row"><span class="label" id="acc1Lbl">Ø§Ù„Ø®Ø²ÙŠÙ†Ø©:</span> <span class="val" id="acc1"></span></div>
    <div class="row"><span class="label" id="acc2Lbl">Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø±:</span> <span class="val" id="acc2"></span></div>
    
    <div class="row"><span class="label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</span> <span class="val" id="method"></span></div>
    <div class="row" id="bankRow" style="display:none"><span class="label">ØªÙØ§ØµÙŠÙ„:</span> <span class="val" id="bank"></span></div>
    <div class="row"><span class="label">ÙˆØ°Ù„Ùƒ Ø¹Ù†:</span> <span class="val" id="desc"></span></div>

    <div class="amount"><span id="amount">0.00</span> Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ</div>

    <div class="sigs">
        <div class="sig">Ø§Ù„Ù…Ø­Ø§Ø³Ø¨</div>
        <div class="sig">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹</div>
        <div class="sig">Ø§Ù„Ù…Ø³ØªÙ„Ù…</div>
    </div>
</div>
<div style="text-align:center; margin-top:20px"><button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button></div>

<script>
    const API = 'http://localhost:5000/api';
    window.onload = async () => {
        const id = new URLSearchParams(window.location.search).get('id');
        const res = await fetch(`${API}/treasury/${id}`);
        const d = await res.json();
        
        document.getElementById('type').innerText = d.type==='Inbound' ? 'Ø¥Ø°Ù† Ù‚Ø¨Ø¶ Ù†Ù‚Ø¯ÙŠØ© (ÙˆØ§Ø±Ø¯)' : 'Ø¥Ø°Ù† ØµØ±Ù Ù†Ù‚Ø¯ÙŠØ© (ØµØ§Ø¯Ø±)';
        document.getElementById('serial').innerText = d.serialNumber;
        document.getElementById('date').innerText = new Date(d.date).toLocaleDateString('ar-EG');
        document.getElementById('acc1').innerText = d.treasuryAccount?.name;
        document.getElementById('acc2').innerText = d.targetAccount?.name;
        document.getElementById('method').innerText = d.paymentMethod;
        document.getElementById('desc').innerText = d.description;
        document.getElementById('amount').innerText = d.amount.toLocaleString();

        if(d.type==='Inbound') {
            document.getElementById('acc1Lbl').innerText = 'Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨:';
            document.getElementById('acc2Lbl').innerText = 'Ø§Ø³ØªÙ„Ù…Ù†Ø§ Ù…Ù†:';
        } else {
            document.getElementById('acc1Lbl').innerText = 'Ù…Ù† Ø­Ø³Ø§Ø¨:';
            document.getElementById('acc2Lbl').innerText = 'ØµØ±ÙÙ†Ø§ Ø¥Ù„Ù‰:';
        }

        if(d.paymentMethod !== 'Cash') {
            document.getElementById('bankRow').style.display = 'flex';
            document.getElementById('bank').innerText = `${d.bankName||''} - Ø±Ù‚Ù…: ${d.checkNumber||''}`;
        }
    };
</script>
</body>
</html>